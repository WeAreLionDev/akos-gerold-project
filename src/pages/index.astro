---
import AboutMeSection from 'src/components/homepage/AboutMeSection.astro'
import HeroSection from 'src/components/homepage/HeroSection.astro'
import MyClientsSection from 'src/components/homepage/MyClientsSection.astro'
import OfferHelpSection from 'src/components/homepage/OfferHelpSection.astro'
import ServiceSection from 'src/components/homepage/ServiceSection.astro'
import WelcomeSection from 'src/components/homepage/WelcomeSection.astro'
import WhatMyClientsThinkSection from 'src/components/homepage/WhatMyClientsThinkSection.astro'
import WorkWithUsSection from 'src/components/homepage/WorkWithUsSection.astro'
import Layout from 'src/layouts/Layout.astro'
import SERVICES from 'src/mocks/services.json'
import TESTIMONIALS from 'src/mocks/testimonials.json'
import CLIENTS from 'src/mocks/clients.json'
import type { ClientType, ServiceType, TestimonialType } from 'src/types'
import { useGetHomepageQuery } from 'src/clients/sanity/queries/homepage/Homepage.queries'

const services: ServiceType[] = SERVICES.map((service: unknown) => service as unknown as ServiceType)
const testimonials: TestimonialType[] = TESTIMONIALS.map((testimonial: unknown) => testimonial as unknown as TestimonialType)
const clients: ClientType[] = CLIENTS.map((client: unknown) => client as unknown as ClientType)

export async function getHomepage() {
  return await useGetHomepageQuery()
}

const homepage = await getHomepage()
---

<Layout title="Akos Gerold Astro + Sanity.io Template" description="Metadescription">
  <code>{JSON.stringify(homepage)}</code>
  <HeroSection {...homepage.heroSection} />
  <WelcomeSection />
  <MyClientsSection clients={clients} />
  <OfferHelpSection />
  {services.map((service) => <ServiceSection {...service} />)}
  <WhatMyClientsThinkSection testimonials={testimonials} />
  <AboutMeSection />
  <WorkWithUsSection />
</Layout>
